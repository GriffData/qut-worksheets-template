
***
*Solution*: 

```{r sim-mix-a, cache=TRUE, echo=TRUE, eval=TRUE}
  
  # (a)

  sim_poisson_mix_2 <- function(lambda_1, lambda_2, p){
    
    x_bernoulli <- rbinom(n = 1, size = 1, prob = p)
    
    if(x_bernoulli == 1L){
      
      z_pois <- rpois(n = 1, lambda = lambda_1)
    
    } else {
      
      z_pois <- rpois(n = 1, lambda = lambda_2)
      
    }
    
    return(z_pois)
    
    # there are more efficient ways to code this...
    # this code emphasises the construction of the
    # random variable, but is not vectorised.
    
  }

  lambda_1 <- 4
  lambda_2 <- 10
  p <- 0.4

  pmix_samples <- replicate(n = 1000, sim_poisson_mix_2(lambda_1 = lambda_1, lambda_2 = lambda_2, p = p))


  # theoretical mean and variance
  mean_poisson_mix_2 <- function(lambda_1, lambda_2, p){
    
    p * lambda_1 + (1 - p) * lambda_2
    
  }
  
  var_poisson_mix_2 <- function(lambda_1, lambda_2, p){
    
    p * lambda_1 + (1 - p) * lambda_2 +  p * (1 - p) * (lambda_1 - lambda_2)^2
    
  }
  
  mean_poisson_mix_2(lambda_1 = lambda_1, lambda_2 = lambda_2, p = p)
  var_poisson_mix_2(lambda_1 = lambda_1, lambda_2 = lambda_2, p = p)

  
  # mean and variance by simulation:
  mean(pmix_samples)
  var(pmix_samples)

```

```{r sim-mix-c, cache=TRUE, echo=TRUE, eval=TRUE}
  
  # (c)

  sim_poisson_mix <- function(lambda, p, n_samples = 1){

    component_id <- sample(x = 1:length(lambda), 
                           size = n_samples, 
                           prob = p,
                           replace = TRUE)
    
    z_pois <- rpois(n = n_samples, lambda = lambda[component_id])
    
    return(z_pois)
    
  }

  mix_df <- tibble(
    z = sim_poisson_mix(c(1,4,8,15),p = c(0.1,0.2,0.1,0.6), n_samples = 1000)
  )
  
  ggplot(data = mix_df, aes(x = z)) +
    geom_histogram(aes(y = ..density.. ), binwidth = 1, colour = "white") +
    theme_bw()

```

```{r sim-mix-d, cache=TRUE, echo=TRUE, eval=TRUE}
  
  # (d)

  

```

***